# Code generated by generate.go. DO NOT EDIT.

import httpx

{{ range $name, $api := . -}}
{{ range $svc := $api.Services -}}
import metalstackcloud.{{ $name | trimSuffix "v1" }}.v1.{{ $svc | trimSuffix "Service" | lower }}_connecpy as {{ $name | trimSuffix "v1" }}_{{ $svc | trimSuffix "Service" | lower }}_connecpy
{{ end }}
{{ end }}

class Client:
    def __init__(self, baseurl: str, token: str, timeout: int = 10):
        self._baseurl = baseurl

        headers = {}
        if token:
            headers["Authorization"] = "Bearer " + token

        self._session = httpx.Client(headers=headers, timeout=timeout)

{{ range $name, $api := . }}
    def {{ $name | lower }}(self):
        return self._{{ $name | title }}(baseurl=self._baseurl, session=self._session)
{{ end }}

{{ range $name, $api := . }}
    class _{{ $name | title }}:
        def __init__(self, baseurl: str, session=None):
            self._baseurl = baseurl
            self._session = session

{{ range $svc := $api.Services }}
        def {{ $svc | trimSuffix "Service" | lower }}(self):
            return {{ $name | trimSuffix "v1" }}_{{ $svc | trimSuffix "Service" | lower }}_connecpy.{{ $svc }}Client(address=self._baseurl, session=self._session)
{{ end }}
{{ end }}